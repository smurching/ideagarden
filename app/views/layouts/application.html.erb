<!DOCTYPE html>
<html>


<head>
  <title>Ideagarden</title>
  <% if request.original_url.index("opengraph_object") != nil%>

  	<meta property="og:url" content="<%=request.base_url+fb_object_path(@idea_posting.id)%>"/>	  
	<meta property="fb:app_id" content="<%=ENV["FACEBOOK_APP_ID"]%>" /> 
	<meta property="og:type" content="<%=ENV["FACEBOOK_APP_NAMESPACE"]%>:project_idea" /> 	
	<meta property="og:title" content="<%=@idea_posting.name%>" />
	<meta property="og:image" content= "<%=request.base_url+"/assets/logo.png"%>"/>
	<meta property="<%=ENV["FACEBOOK_APP_NAMESPACE"]%>:pitch" content="<%=@idea_posting.pitch%>" />
	<%end%>

    
  <%= stylesheet_link_tag "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>

  
</head>

<body>
	
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : <%= ENV['FACEBOOK_APP_ID']%>,                        // App ID from the app dashboard
      channelUrl : '<%=root_path%>/channel.html', // Channel file for x-domain comms
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
   
  };

  // Load the SDK asynchronously
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/all.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
   
   
 
</script>


	
  <div id='header'>
    <h1><%= link_to image_tag('logo.png', id: 'logo'), root_path %></h1>
    <div id='navLinks'>
      <% if logged_in? && registration_complete? %>
      	<%= link_to 'Welcome, '+current_user.profile.name, user_profiles_path(current_user.id)%> |
        <%= link_to 'New Idea Posting', new_idea_posting_path %> |
        <%= link_to "Logout", logout_path %> |
		<%= link_to "Requests ("+number_of_requests.to_s+")", list_joinrequests_path, :id => "pending_requests"%> |		
		<%= link_to "Following", show_following_path %> |
		<%= link_to "Followers", show_followers_path %> |
		<%= link_to 'Search', search_path %> |
		<%= link_to 'Inbox', private_messages_path %>
      	<%end%>
        
	  <% if logged_in? && registration_complete? == false %>
	  	 <% if current_user.profile == nil %>
	  	 	<%= link_to 'Complete Profile', new_user_profile_path(current_user.id) %> |
	  	 <%end%>

	  	 
	  	 <% unless current_user.confirmed == true %>
	  	 	<%= link_to 'Resend Confirmation Email', resend_user_confirmation_path%> |
	  	 <%end%>
	  	 <%= link_to "Logout", logout_path, :remote => true%> |
	  	 <%= link_to 'Search Posts ', search_path %>
	  <%end%> 

        
      <% if logged_in? == false %>
        <%= link_to "Login", login_path, :id => "login", :remote => true %> |   
        
        <%if false%>
        	<%= link_to "Login through Facebook", 
        	"https://www.facebook.com/dialog/oauth?"+"client_id="+ENV["FACEBOOK_APP_ID"]+"&redirect_uri=http://localhost:3000/fb_login"+"&state=login"%> | 
        	<%= link_to "Register through Facebook", 
        	"https://www.facebook.com/dialog/oauth?"+"client_id="+ENV["FACEBOOK_APP_ID"]+"&redirect_uri=http://localhost:3000/users/new"+"&state=register"%> |
        <%end%>
                 
    	<%= link_to "Login through Facebook", "/auth/facebook?&state=login"%> | 
    	<%= link_to "Register through Facebook", "/auth/facebook?&state=register"%> |     	
    
         
        <%= link_to 'Register', new_user_path, :id => "register", :remote => true%> |
        <%= link_to 'Search Posts ', search_path %> |
        <%= link_to 'Forgot password?', new_pw_reset_path%>

      <% end %>
    </div>
  </div>

  <div id='wrapper'>

    <%= content_tag(:p, notice, :class => 'notice') if notice.present? %>
    <%= content_tag(:p, alert, :class => 'alert') if alert.present? %>

    <%= yield %>
    

  </div>

</body>
</html>

